@{
    Layout = "_Layout";
}
@{
    ViewData["Title"] = "Chanteurs";
}

<!DOCTYPE html>
<html lang="en">
<head>
  <title>Chanteurs</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
</head>
<body>

<div class="container mt-3">
    <h2>Chanteurs</h2>
    <div id="chanteurs-container"></div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script>
    $(document).ready(function() {
        // Make HTTP request to API endpoint
        $.get("api/Chanteurs", function(chanteurs) {
            // Iterate through chanteurs and render in cards
            chanteurs.forEach(function(chanteur) {
                var chanteurCard = `
                <div class="card mb-3">
                    <div class="card-header">
                        <h4 class="card-title">${chanteur.nom}</h4>
                    </div>
                    <div class="card-body">
                        <img class="card-img-top" src="${chanteur.image}" alt="${chanteur.nom}" style="width:100%">
                        <h5 class="mt-2">Albums:</h5>
                        <ul id="albums-${chanteur.idChanteur}" class="list-group">
                            <!-- Albums will be dynamically added here -->
                        </ul>
                        <button class="btn btn-primary mt-2" onclick="loadMoreAlbums(${chanteur.idChanteur})">See More Albums</button>
                    </div>
                </div>`;
                $("#chanteurs-container").append(chanteurCard);

                // Load initial albums for the chanteur
                loadAlbums(chanteur.idChanteur, 3);
            });
        });
    });

    // Function to load albums for a specific chanteur
    function loadAlbums(chanteurId, count) {
        $.get(`/api/chanteurs/${chanteurId}/albums?count=${count}`, function(albums) {
            var albumList = "";
            albums.forEach(function(album) {
                albumList += `<li class="list-group-item">${album.nomAlbum}</li>`;
            });
            $("#albums-" + chanteurId).append(albumList);
        });
    }

    // Function to load more albums for a specific chanteur
    function loadMoreAlbums(chanteurId) {
        loadAlbums(chanteurId, 5); // Load 5 more albums
    }
</script>

</body>
</html>
